<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CLARA: Clinical Legal AI for Risk Avoidance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü©∫</text></svg>">
    <style>
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .mode-btn.active {
            background-color: white;
            color: #3b82f6;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .input-error { border-color: #ef4444 !important; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .pulse-dot { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .tooltip { position: relative; }
        .tooltip:hover::after { content: attr(data-tooltip); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); 
            background: #1e293b; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; white-space: nowrap; z-index: 100; }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.28.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0"
  }
}
</script>

</head>
<body class="bg-slate-100 text-slate-800 font-sans">
    <header class="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-20">
        <div class="container mx-auto px-4 md:px-8 py-3 flex justify-between items-center flex-wrap gap-2">
            <div class="flex items-center space-x-4">
                <div class="text-4xl">ü©∫</div>
                <div>
                    <h1 class="text-2xl font-bold text-slate-800">CLARA</h1>
                    <p class="text-sm text-slate-500">Clinical Legal AI for Risk Avoidance</p>
                </div>
                <div class="hidden md:flex items-center space-x-2 ml-4">
                    <span class="pulse-dot w-2 h-2 bg-green-500 rounded-full"></span>
                    <span class="text-xs text-green-600 font-medium">AI Online</span>
                </div>
            </div>
            <!-- Mode Tabs -->
            <div class="flex items-center border border-slate-200 rounded-lg p-1 bg-slate-100 flex-wrap">
                <button id="transcript-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üìù Analysis
                </button>
                <button id="live-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üéôÔ∏è Live
                </button>
                <button id="appointments-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üìÖ Appointments
                </button>
                <button id="doctors-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üë®‚Äç‚öïÔ∏è Doctors
                </button>
                <button id="prescriptions-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üíä Prescriptions
                </button>
                <button id="records-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üìÅ Records
                </button>
                <button id="statistics-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üìä Stats
                </button>
                <button id="rag-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üß† Knowledge
                </button>
                <button id="ml-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üêç ML Analytics
                </button>
                <button id="impact-mode-btn" class="mode-btn px-3 py-1.5 text-sm font-semibold rounded-md transition-colors duration-200">
                    üìà Impact
                </button>
            </div>
            <!-- Python Service Status -->
            <div id="python-status" class="hidden md:flex items-center space-x-2 ml-2 px-2 py-1 bg-slate-50 rounded">
                <span class="w-2 h-2 rounded-full" id="python-status-dot"></span>
                <span class="text-xs" id="python-status-text">Python</span>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        <!-- Transcript Analysis View -->
        <div id="transcript-analysis-view">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 items-start">
                <!-- Input Column -->
                <div class="lg:col-span-4 space-y-4">
                    <!-- Demo Patient Selector -->
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-200">
                        <div class="flex items-center justify-between mb-3">
                            <h3 class="text-sm font-semibold text-blue-800">üß™ Quick Demo</h3>
                            <button id="sync-demo-btn" class="text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700 transition-colors">
                                Sync Demo Data
                            </button>
                        </div>
                        <select id="demo-patient-select" class="w-full p-2 border border-blue-300 rounded-md bg-white text-sm focus:ring-2 focus:ring-blue-500">
                            <option value="">Select a demo patient...</option>
                        </select>
                    </div>

                    <!-- Patient Information Form -->
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200 sticky top-24">
                        <h2 class="text-lg font-semibold text-slate-700 mb-4 flex items-center">
                            <span class="mr-2">üë§</span> Patient Information
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Row 1: Name and ID -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Full Name <span class="text-red-500">*</span></label>
                                    <input type="text" id="patient-name-input" placeholder="John Doe" required
                                        class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <span class="text-xs text-red-500 hidden" id="name-error">Name is required</span>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Patient ID</label>
                                    <input type="text" id="patient-id-input" placeholder="Auto-generated" readonly
                                        class="w-full p-2 text-sm border border-slate-300 rounded-md bg-slate-50 text-slate-500">
                                </div>
                            </div>

                            <!-- Row 2: Age and DOB -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Age <span class="text-red-500">*</span></label>
                                    <input type="number" id="patient-age-input" placeholder="58" min="0" max="150" required
                                        class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <span class="text-xs text-red-500 hidden" id="age-error">Valid age required</span>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Date of Birth <span class="text-red-500">*</span></label>
                                    <input type="date" id="patient-dob-input" required
                                        class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <span class="text-xs text-red-500 hidden" id="dob-error">DOB is required</span>
                                </div>
                            </div>

                            <!-- Row 3: Phone and Email -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Phone <span class="text-red-500">*</span></label>
                                    <input type="tel" id="patient-phone-input" placeholder="+91 98765 43210" required
                                        class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <span class="text-xs text-red-500 hidden" id="phone-error">Valid phone required</span>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Email <span class="text-red-500">*</span></label>
                                    <input type="email" id="patient-email-input" placeholder="patient@email.com" required
                                        class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <span class="text-xs text-red-500 hidden" id="email-error">Valid email required</span>
                                </div>
                            </div>

                            <!-- Row 4: Gender and Blood Group -->
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Gender</label>
                                    <select id="patient-gender-input" class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                        <option value="">Select...</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Blood Group</label>
                                    <select id="patient-blood-input" class="w-full p-2 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                                        <option value="">Select...</option>
                                        <option value="A+">A+</option>
                                        <option value="A-">A-</option>
                                        <option value="B+">B+</option>
                                        <option value="B-">B-</option>
                                        <option value="AB+">AB+</option>
                                        <option value="AB-">AB-</option>
                                        <option value="O+">O+</option>
                                        <option value="O-">O-</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Clinical Transcript -->
                            <div>
                                <label class="block text-xs font-medium text-slate-600 mb-1">Clinical Transcript <span class="text-red-500">*</span></label>
                                <textarea id="transcript-input" placeholder="Enter or paste clinical notes here..."
                                    class="w-full h-48 p-3 text-sm border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-y"></textarea>
                                <span class="text-xs text-red-500 hidden" id="transcript-error">Transcript is required</span>
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex space-x-2">
                                <button id="analyze-button"
                                    class="flex-1 bg-blue-600 text-white font-semibold py-3 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors duration-200 flex items-center justify-center">
                                    üîç Analyze
                                </button>
                                <button id="clear-form-btn" class="px-4 py-3 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 transition-colors" title="Clear Form">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analysis Columns (Nav + Content) -->
                <div id="analysis-section" class="lg:col-span-8 grid grid-cols-1 md:grid-cols-12 gap-6 items-start hidden">
                    <!-- Navigation Column -->
                    <nav id="analysis-nav" class="md:col-span-3 sticky top-24">
                        <ul class="space-y-2"></ul>
                    </nav>
                    <!-- Content Column -->
                    <div id="analysis-output" class="md:col-span-9 space-y-6"></div>
                </div>

                <!-- Initial State / Loading / Error Column -->
                <div id="placeholder-section" class="lg:col-span-8"></div>
            </div>
        </div>
        
        <!-- Live Conversation View -->
        <div id="live-conversation-view" class="hidden">
            <div class="max-w-4xl mx-auto bg-white p-6 rounded-xl shadow-md border border-slate-200">
                <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
                    <h2 class="text-lg font-semibold text-slate-700">üéôÔ∏è Live Doctor-Patient Conversation</h2>
                    <div class="flex items-center space-x-2">
                        <label class="text-sm font-medium text-slate-600">Patient Age:</label>
                        <input type="number" id="live-patient-age-input" placeholder="58" class="w-20 p-2 border border-slate-300 rounded-md text-sm">
                    </div>
                </div>
                <div id="live-transcript-output" class="w-full h-96 p-4 border border-slate-300 rounded-md overflow-y-auto bg-slate-50 mb-4 space-y-4">
                    <div class="flex flex-col items-center justify-center h-full text-center text-slate-500 p-8">
                        <div class="text-4xl mb-3">üéôÔ∏è</div>
                        <p>Set the patient's age above, then click "Start Conversation" to begin the AI interview.</p>
                    </div>
                </div>
                <button id="live-conversation-btn"
                    class="w-full bg-green-600 text-white font-semibold py-3 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center">
                </button>
            </div>
        </div>
        
        <!-- Patient Records View -->
        <div id="records-view" class="hidden">
            <div class="max-w-5xl mx-auto">
                <!-- Search and Filter Bar -->
                <div class="bg-white p-4 rounded-xl shadow-md border border-slate-200 mb-4">
                    <div class="flex flex-wrap gap-3 items-center">
                        <div class="flex-1 min-w-[200px]">
                            <input type="text" id="records-search" placeholder="üîç Search patients..."
                                class="w-full p-2 border border-slate-300 rounded-md text-sm">
                        </div>
                        <select id="records-filter-risk" class="p-2 border border-slate-300 rounded-md text-sm">
                            <option value="">All Risk Levels</option>
                            <option value="low">Low Risk</option>
                            <option value="medium">Medium Risk</option>
                            <option value="high">High Risk</option>
                            <option value="critical">Critical</option>
                        </select>
                        <button id="export-all-btn" class="px-4 py-2 bg-green-600 text-white rounded-md text-sm font-semibold hover:bg-green-700">
                            üì• Export All
                        </button>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">üìÅ Saved Patient Records</h2>
                    <div id="records-list" class="space-y-4"></div>
                </div>
            </div>
        </div>

        <!-- Statistics View -->
        <div id="statistics-view" class="hidden">
            <div class="max-w-6xl mx-auto space-y-6">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">Total Analyses</p>
                                <p id="stat-total-analyses" class="text-3xl font-bold text-slate-800">0</p>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-lg">üìä</div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">Avg Risk Score</p>
                                <p id="stat-avg-risk" class="text-3xl font-bold text-slate-800">0%</p>
                            </div>
                            <div class="bg-orange-100 p-3 rounded-lg">‚ö†Ô∏è</div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">This Week</p>
                                <p id="stat-this-week" class="text-3xl font-bold text-slate-800">0</p>
                            </div>
                            <div class="bg-green-100 p-3 rounded-lg">üìÖ</div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">High Risk Cases</p>
                                <p id="stat-high-risk" class="text-3xl font-bold text-red-600">0</p>
                            </div>
                            <div class="bg-red-100 p-3 rounded-lg">üö®</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">ü¶† Most Common Diseases</h3>
                        <div id="common-diseases-chart" class="space-y-3">
                            <p class="text-slate-500 text-center py-8">No data available yet</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">‚ö†Ô∏è Risk Level Distribution</h3>
                        <div id="risk-distribution-chart" class="space-y-3">
                            <p class="text-slate-500 text-center py-8">No data available yet</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">üíä Most Prescribed Medications</h3>
                        <div id="top-medications-chart" class="space-y-3">
                            <p class="text-slate-500 text-center py-8">No data available yet</p>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <h3 class="text-lg font-semibold text-slate-800 mb-4">üìà Weekly Analysis Trend</h3>
                        <div id="weekly-trend-chart" class="space-y-3">
                            <p class="text-slate-500 text-center py-8">No data available yet</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RAG Knowledge Base View -->
        <div id="rag-view" class="hidden">
            <div class="max-w-4xl mx-auto space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">üß† Medical Knowledge Base</h2>
                    <p class="text-slate-600 mb-4">Search our RAG-enhanced medical knowledge base for drug interactions, disease information, and ICD-10 codes.</p>
                    
                    <div class="flex space-x-2 mb-6">
                        <input type="text" id="rag-search-input" placeholder="Search drugs, diseases, ICD-10 codes..."
                            class="flex-1 p-3 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <button id="rag-search-btn" class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700">
                            üîç Search
                        </button>
                    </div>
                    
                    <div id="rag-results" class="space-y-4">
                        <!-- Results will be injected here -->
                    </div>
                </div>

                <!-- Drug Interaction Checker -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4">üíä Drug Interaction Checker</h3>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <input type="text" id="drug1-input" placeholder="First drug (e.g., Warfarin)"
                            class="p-2 border border-slate-300 rounded-md">
                        <input type="text" id="drug2-input" placeholder="Second drug (e.g., Aspirin)"
                            class="p-2 border border-slate-300 rounded-md">
                    </div>
                    <button id="check-interaction-btn" class="w-full py-2 bg-purple-600 text-white font-semibold rounded-md hover:bg-purple-700">
                        Check Interaction
                    </button>
                    <div id="interaction-result" class="mt-4 p-4 rounded-md hidden"></div>
                </div>

                <!-- Agent Execution Trace -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4">ü§ñ AI Agent Activity</h3>
                    <div id="agent-trace" class="space-y-2 text-sm">
                        <p class="text-slate-500 text-center py-4">No recent agent activity</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ML Analytics View (Python-powered) -->
        <div id="ml-analytics-view" class="hidden">
            <div class="space-y-6">
                <!-- Dashboard Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-5 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-blue-100 text-sm">Total Analyses</p>
                                <h3 class="text-3xl font-bold" id="ml-total-analyses">--</h3>
                                <p class="text-xs text-blue-200 mt-1" id="ml-analyses-change">Loading...</p>
                            </div>
                            <span class="text-4xl opacity-80">üìä</span>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-orange-500 to-orange-600 text-white p-5 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-orange-100 text-sm">Avg Risk Score</p>
                                <h3 class="text-3xl font-bold" id="ml-avg-risk">--</h3>
                                <p class="text-xs text-orange-200 mt-1" id="ml-risk-change">vs last period</p>
                            </div>
                            <span class="text-4xl opacity-80">‚ö†Ô∏è</span>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-red-500 to-red-600 text-white p-5 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-red-100 text-sm">High Risk Cases</p>
                                <h3 class="text-3xl font-bold" id="ml-high-risk">--</h3>
                                <p class="text-xs text-red-200 mt-1" id="ml-high-risk-change">Requiring attention</p>
                            </div>
                            <span class="text-4xl opacity-80">üö®</span>
                        </div>
                    </div>
                    <div class="bg-gradient-to-br from-green-500 to-green-600 text-white p-5 rounded-xl shadow-lg">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="text-green-100 text-sm">ML Accuracy</p>
                                <h3 class="text-3xl font-bold" id="ml-accuracy">--</h3>
                                <p class="text-xs text-green-200 mt-1">Model performance</p>
                            </div>
                            <span class="text-4xl opacity-80">üéØ</span>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Python ML Prediction Panel -->
                    <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                        <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center">
                            <span class="mr-2">üêç</span> ML Risk Prediction
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">Use Python ML model for enhanced risk prediction</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Patient Age</label>
                                <input type="number" id="ml-age-input" placeholder="65" class="w-full p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Conditions (comma-separated)</label>
                                <input type="text" id="ml-diseases-input" placeholder="Diabetes, Hypertension" class="w-full p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Medications (comma-separated)</label>
                                <input type="text" id="ml-meds-input" placeholder="Metformin, Lisinopril" class="w-full p-2 border rounded-md">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Symptoms (comma-separated)</label>
                                <input type="text" id="ml-symptoms-input" placeholder="Chest pain, Fatigue" class="w-full p-2 border rounded-md">
                            </div>
                            <button id="run-ml-prediction" class="w-full bg-purple-600 text-white py-2 rounded-lg font-semibold hover:bg-purple-700 transition-colors">
                                üîÆ Run ML Prediction
                            </button>
                        </div>
                        
                        <div id="ml-prediction-result" class="mt-4 hidden">
                            <div class="border-t pt-4">
                                <h4 class="font-semibold text-slate-700 mb-2">Prediction Results</h4>
                                <div id="ml-result-content" class="space-y-2"></div>
                            </div>
                        </div>
                    </div>

                    <!-- NLP Analysis Panel -->
                    <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                        <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center">
                            <span class="mr-2">üìù</span> NLP Transcript Analysis
                        </h3>
                        <p class="text-sm text-slate-500 mb-4">Analyze clinical transcripts using Python NLP</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-700 mb-1">Clinical Transcript</label>
                                <textarea id="ml-transcript-input" rows="6" placeholder="Paste clinical transcript here..." 
                                    class="w-full p-2 border rounded-md resize-none"></textarea>
                            </div>
                            <button id="run-nlp-analysis" class="w-full bg-teal-600 text-white py-2 rounded-lg font-semibold hover:bg-teal-700 transition-colors">
                                üîç Analyze with NLP
                            </button>
                        </div>
                        
                        <div id="nlp-analysis-result" class="mt-4 hidden">
                            <div class="border-t pt-4">
                                <h4 class="font-semibold text-slate-700 mb-2">NLP Results</h4>
                                <div id="nlp-result-content" class="space-y-2"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Clinical Insights Panel -->
                <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center">
                        <span class="mr-2">üí°</span> Clinical Insights & Outcome Predictions
                    </h3>
                    <div id="clinical-insights-content" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="p-4 bg-blue-50 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">30-Day Hospitalization Risk</h4>
                            <div class="text-3xl font-bold text-blue-600" id="hosp-risk">--%</div>
                            <p class="text-sm text-blue-600" id="hosp-risk-level">--</p>
                        </div>
                        <div class="p-4 bg-orange-50 rounded-lg">
                            <h4 class="font-semibold text-orange-800 mb-2">30-Day Readmission Risk</h4>
                            <div class="text-3xl font-bold text-orange-600" id="readmit-risk">--%</div>
                            <p class="text-sm text-orange-600" id="readmit-risk-level">--</p>
                        </div>
                        <div class="p-4 bg-green-50 rounded-lg">
                            <h4 class="font-semibold text-green-800 mb-2">Overall Prognosis</h4>
                            <div class="text-3xl font-bold text-green-600" id="prognosis-score">--</div>
                            <p class="text-sm text-green-600" id="prognosis-status">--</p>
                        </div>
                    </div>
                </div>

                <!-- Trend Charts -->
                <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center">
                        <span class="mr-2">üìà</span> Weekly Trend Analysis
                    </h3>
                    <div id="trend-chart-container" class="h-64 flex items-center justify-center">
                        <button id="load-trends-btn" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-700">
                            Load Trend Data
                        </button>
                    </div>
                    <div id="trend-data-display" class="hidden mt-4 overflow-x-auto">
                        <table class="min-w-full text-sm">
                            <thead>
                                <tr class="bg-slate-100">
                                    <th class="px-4 py-2 text-left">Day</th>
                                    <th class="px-4 py-2 text-left">Analyses</th>
                                    <th class="px-4 py-2 text-left">Avg Risk</th>
                                    <th class="px-4 py-2 text-left">High Risk</th>
                                </tr>
                            </thead>
                            <tbody id="trend-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Impact Measurement View -->
        <div id="impact-view" class="hidden">
            <div class="space-y-6">
                <div class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-xl shadow-lg">
                    <h2 class="text-2xl font-bold mb-2">üìà Measurable Impact Dashboard</h2>
                    <p class="text-purple-100">Track clinical improvements and measure the impact of CLARA on patient outcomes</p>
                </div>

                <!-- Impact Score Card -->
                <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold text-slate-800">Overall Impact Score</h3>
                        <button id="refresh-impact" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:bg-indigo-700">
                            üîÑ Refresh
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div class="text-center p-4 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg">
                            <div class="text-5xl font-bold text-indigo-600" id="impact-score">--</div>
                            <p class="text-sm text-slate-600 mt-1">Impact Score</p>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-3xl font-bold text-green-600" id="improvements-count">--</div>
                            <p class="text-sm text-slate-600 mt-1">Improvements</p>
                        </div>
                        <div class="text-center p-4 bg-yellow-50 rounded-lg">
                            <div class="text-3xl font-bold text-yellow-600" id="focus-areas-count">--</div>
                            <p class="text-sm text-slate-600 mt-1">Focus Areas</p>
                        </div>
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-3xl font-bold text-blue-600" id="total-tracked">--</div>
                            <p class="text-sm text-slate-600 mt-1">Cases Tracked</p>
                        </div>
                    </div>
                </div>

                <!-- Before/After Comparison -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                        <h3 class="text-lg font-bold text-slate-800 mb-4">üìâ Before Period</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-slate-50 rounded">
                                <span class="text-slate-600">Analyses</span>
                                <span class="font-bold" id="before-analyses">--</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-slate-50 rounded">
                                <span class="text-slate-600">Avg Risk Score</span>
                                <span class="font-bold" id="before-risk">--</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-slate-50 rounded">
                                <span class="text-slate-600">High Risk Rate</span>
                                <span class="font-bold" id="before-high-risk">--</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                        <h3 class="text-lg font-bold text-slate-800 mb-4">üìà After Period</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center p-3 bg-green-50 rounded">
                                <span class="text-slate-600">Analyses</span>
                                <span class="font-bold text-green-600" id="after-analyses">--</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-green-50 rounded">
                                <span class="text-slate-600">Avg Risk Score</span>
                                <span class="font-bold text-green-600" id="after-risk">--</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-green-50 rounded">
                                <span class="text-slate-600">High Risk Rate</span>
                                <span class="font-bold text-green-600" id="after-high-risk">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Improvement Details -->
                <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">‚úÖ Improvements Achieved</h3>
                    <div id="improvements-list" class="space-y-2">
                        <p class="text-slate-500">Click refresh to load impact data...</p>
                    </div>
                </div>

                <!-- Clinical Metrics Calculator -->
                <div class="bg-white rounded-xl shadow-md border border-slate-200 p-6">
                    <h3 class="text-lg font-bold text-slate-800 mb-4">üßÆ Clinical Metrics Calculator</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- NNT Calculator -->
                        <div class="p-4 border rounded-lg">
                            <h4 class="font-semibold text-slate-700 mb-3">Number Needed to Treat (NNT)</h4>
                            <input type="number" step="0.01" placeholder="Risk Reduction (e.g., 0.1)" 
                                id="nnt-risk-reduction" class="w-full p-2 border rounded mb-2">
                            <input type="number" step="0.01" placeholder="Baseline Risk (e.g., 0.2)" 
                                id="nnt-baseline-risk" class="w-full p-2 border rounded mb-2">
                            <button id="calc-nnt" class="w-full bg-blue-600 text-white py-2 rounded font-semibold hover:bg-blue-700">
                                Calculate NNT
                            </button>
                            <div id="nnt-result" class="mt-2 text-center font-bold text-lg text-blue-600"></div>
                        </div>

                        <!-- Odds Ratio Calculator -->
                        <div class="p-4 border rounded-lg">
                            <h4 class="font-semibold text-slate-700 mb-3">Odds Ratio</h4>
                            <div class="grid grid-cols-2 gap-2 mb-2">
                                <input type="number" placeholder="Exposed Events" id="or-exposed-events" class="p-2 border rounded">
                                <input type="number" placeholder="Exposed Total" id="or-exposed-total" class="p-2 border rounded">
                                <input type="number" placeholder="Control Events" id="or-control-events" class="p-2 border rounded">
                                <input type="number" placeholder="Control Total" id="or-control-total" class="p-2 border rounded">
                            </div>
                            <button id="calc-or" class="w-full bg-purple-600 text-white py-2 rounded font-semibold hover:bg-purple-700">
                                Calculate OR
                            </button>
                            <div id="or-result" class="mt-2 text-center font-bold text-lg text-purple-600"></div>
                        </div>

                        <!-- Sensitivity/Specificity Calculator -->
                        <div class="p-4 border rounded-lg">
                            <h4 class="font-semibold text-slate-700 mb-3">Diagnostic Accuracy</h4>
                            <div class="grid grid-cols-2 gap-2 mb-2">
                                <input type="number" placeholder="True Pos (TP)" id="diag-tp" class="p-2 border rounded">
                                <input type="number" placeholder="False Pos (FP)" id="diag-fp" class="p-2 border rounded">
                                <input type="number" placeholder="True Neg (TN)" id="diag-tn" class="p-2 border rounded">
                                <input type="number" placeholder="False Neg (FN)" id="diag-fn" class="p-2 border rounded">
                            </div>
                            <button id="calc-diag" class="w-full bg-teal-600 text-white py-2 rounded font-semibold hover:bg-teal-700">
                                Calculate
                            </button>
                            <div id="diag-result" class="mt-2 text-sm text-teal-600"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Appointments View -->
        <div id="appointments-view" class="hidden">
            <div class="max-w-6xl mx-auto space-y-6">
                <!-- Auth Status Bar -->
                <div id="auth-status-bar" class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-4 rounded-xl shadow-md">
                    <div class="flex flex-wrap justify-between items-center gap-4">
                        <div id="auth-user-info" class="flex items-center space-x-3">
                            <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center text-xl">üë§</div>
                            <div>
                                <p class="font-semibold" id="auth-user-name">Not logged in</p>
                                <p class="text-xs text-blue-200" id="auth-user-role">Please login to book appointments</p>
                            </div>
                        </div>
                        <div class="flex space-x-2" id="auth-buttons">
                            <button id="show-login-btn" class="px-4 py-2 bg-white text-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition">
                                Login
                            </button>
                            <button id="show-register-btn" class="px-4 py-2 bg-blue-800 text-white rounded-lg font-semibold hover:bg-blue-900 transition">
                                Register
                            </button>
                        </div>
                        <button id="logout-btn" class="hidden px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition">
                            Logout
                        </button>
                    </div>
                </div>

                <!-- Appointment Dashboard -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">Upcoming</p>
                                <p id="apt-upcoming-count" class="text-3xl font-bold text-blue-600">0</p>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-lg text-2xl">üìÖ</div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">Completed</p>
                                <p id="apt-completed-count" class="text-3xl font-bold text-green-600">0</p>
                            </div>
                            <div class="bg-green-100 p-3 rounded-lg text-2xl">‚úÖ</div>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-slate-500">Cancelled</p>
                                <p id="apt-cancelled-count" class="text-3xl font-bold text-red-600">0</p>
                            </div>
                            <div class="bg-red-100 p-3 rounded-lg text-2xl">‚ùå</div>
                        </div>
                    </div>
                </div>

                <!-- Book New Appointment Section -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                        <span class="mr-2">üìÖ</span> Book New Appointment
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Select Doctor</label>
                            <select id="apt-doctor-select" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Choose a doctor...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Date</label>
                            <input type="date" id="apt-date-input" min="" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Available Slots</label>
                            <select id="apt-slot-select" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500" disabled>
                                <option value="">Select date first...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Type</label>
                            <select id="apt-type-select" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="regular">Regular Consultation</option>
                                <option value="followup">Follow-up</option>
                                <option value="emergency">Emergency</option>
                                <option value="telemedicine">Telemedicine (Video)</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Reason for Visit *</label>
                            <input type="text" id="apt-reason-input" placeholder="e.g., General checkup, Fever and cold..." 
                                class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Symptoms (comma-separated)</label>
                            <input type="text" id="apt-symptoms-input" placeholder="e.g., Headache, Fatigue, Cough..." 
                                class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div id="apt-fee-display" class="mb-4 p-3 bg-blue-50 rounded-lg hidden">
                        <span class="text-slate-600">Consultation Fee: </span>
                        <span class="font-bold text-blue-600" id="apt-fee-amount">‚Çπ0</span>
                    </div>
                    <button id="book-appointment-btn" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition disabled:bg-slate-400" disabled>
                        üìÖ Book Appointment
                    </button>
                </div>

                <!-- My Appointments List -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
                        <h2 class="text-xl font-bold text-slate-800">üìã My Appointments</h2>
                        <div class="flex space-x-2">
                            <select id="apt-filter-status" class="p-2 border border-slate-300 rounded-lg text-sm">
                                <option value="">All Status</option>
                                <option value="scheduled">Scheduled</option>
                                <option value="confirmed">Confirmed</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                    </div>
                    <div id="appointments-list" class="space-y-4">
                        <div class="text-center py-8 text-slate-500">
                            <div class="text-4xl mb-2">üìÖ</div>
                            <p>No appointments found. Book your first appointment above!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Doctors View -->
        <div id="doctors-view" class="hidden">
            <div class="max-w-6xl mx-auto space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">üë®‚Äç‚öïÔ∏è Find Doctors</h2>
                    
                    <!-- Search Filters -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div>
                            <input type="text" id="doc-search-input" placeholder="üîç Search by name..." 
                                class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <select id="doc-specialization-filter" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">All Specializations</option>
                            </select>
                        </div>
                        <div>
                            <input type="date" id="doc-availability-date" placeholder="Check availability" 
                                class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <button id="doc-search-btn" class="w-full bg-blue-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-blue-700 transition">
                                üîç Search
                            </button>
                        </div>
                    </div>
                    
                    <!-- Doctors Grid -->
                    <div id="doctors-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="col-span-full text-center py-8 text-slate-500">
                            <div class="text-4xl mb-2">üë®‚Äç‚öïÔ∏è</div>
                            <p>Loading doctors...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Prescriptions View -->
        <div id="prescriptions-view" class="hidden">
            <div class="max-w-6xl mx-auto space-y-6">
                <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                    <div class="flex justify-between items-center mb-6 flex-wrap gap-2">
                        <h2 class="text-2xl font-bold text-slate-800">üíä My Prescriptions</h2>
                        <div class="flex space-x-2">
                            <input type="text" id="rx-search-input" placeholder="üîç Search prescriptions..." 
                                class="p-2 border border-slate-300 rounded-lg text-sm">
                        </div>
                    </div>
                    
                    <div id="prescriptions-list" class="space-y-4">
                        <div class="text-center py-8 text-slate-500">
                            <div class="text-4xl mb-2">üíä</div>
                            <p>No prescriptions found.</p>
                        </div>
                    </div>
                </div>

                <!-- Doctor Prescription Form (shown to doctors) -->
                <div id="prescription-form-section" class="bg-white p-6 rounded-xl shadow-md border border-slate-200 hidden">
                    <h2 class="text-xl font-bold text-slate-800 mb-4">‚úçÔ∏è Create Prescription</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Patient</label>
                            <select id="rx-patient-select" class="w-full p-3 border border-slate-300 rounded-lg">
                                <option value="">Select patient...</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Related Appointment</label>
                            <select id="rx-appointment-select" class="w-full p-3 border border-slate-300 rounded-lg">
                                <option value="">Select appointment (optional)...</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Diagnosis -->
                    <div class="mb-4">
                        <label class="block text-xs font-medium text-slate-600 mb-1">Diagnosis</label>
                        <div id="diagnosis-list" class="space-y-2 mb-2"></div>
                        <div class="flex space-x-2">
                            <input type="text" id="diagnosis-input" placeholder="Condition (e.g., Hypertension)" class="flex-1 p-2 border rounded-lg">
                            <input type="text" id="icd-input" placeholder="ICD-10 Code" class="w-32 p-2 border rounded-lg">
                            <select id="severity-input" class="p-2 border rounded-lg">
                                <option value="mild">Mild</option>
                                <option value="moderate">Moderate</option>
                                <option value="severe">Severe</option>
                            </select>
                            <button id="add-diagnosis-btn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">+</button>
                        </div>
                    </div>
                    
                    <!-- Medications -->
                    <div class="mb-4">
                        <label class="block text-xs font-medium text-slate-600 mb-1">Medications (Rx)</label>
                        <div id="medications-list" class="space-y-2 mb-2"></div>
                        <div class="grid grid-cols-6 gap-2">
                            <input type="text" id="med-name-input" placeholder="Medicine name" class="col-span-2 p-2 border rounded-lg">
                            <input type="text" id="med-dosage-input" placeholder="Dosage (e.g., 500mg)" class="p-2 border rounded-lg">
                            <input type="text" id="med-frequency-input" placeholder="Frequency" class="p-2 border rounded-lg">
                            <input type="text" id="med-duration-input" placeholder="Duration" class="p-2 border rounded-lg">
                            <button id="add-medication-btn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">+ Add</button>
                        </div>
                    </div>
                    
                    <!-- Advice & Follow-up -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Medical Advice</label>
                            <textarea id="rx-advice-input" rows="3" placeholder="Rest well, Stay hydrated..." class="w-full p-3 border border-slate-300 rounded-lg"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-slate-600 mb-1">Follow-up Date</label>
                            <input type="date" id="rx-followup-date" class="w-full p-3 border border-slate-300 rounded-lg mb-2">
                            <input type="text" id="rx-followup-instructions" placeholder="Follow-up instructions..." class="w-full p-3 border border-slate-300 rounded-lg">
                        </div>
                    </div>
                    
                    <!-- AI Drug Interaction Warning -->
                    <div id="drug-interaction-warning" class="hidden mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                        <h4 class="font-semibold text-yellow-800 mb-2">‚ö†Ô∏è AI Drug Interaction Alert</h4>
                        <div id="drug-warnings-content" class="text-sm text-yellow-700"></div>
                    </div>
                    
                    <button id="create-prescription-btn" class="w-full bg-green-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-green-700 transition">
                        ‚úçÔ∏è Create & Sign Prescription
                    </button>
                </div>
            </div>
        </div>

        <!-- Login Modal -->
        <div id="login-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl fade-in">
                <div class="text-center mb-6">
                    <div class="text-4xl mb-2">üîê</div>
                    <h2 class="text-2xl font-bold text-slate-800">Welcome Back</h2>
                    <p class="text-slate-500">Login to your CLARA account</p>
                </div>
                <form id="login-form" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">Email</label>
                        <input type="email" id="login-email" required placeholder="your@email.com" 
                            class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">Password</label>
                        <input type="password" id="login-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                            class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div id="login-error" class="text-red-500 text-sm hidden"></div>
                    <button type="submit" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition">
                        Login
                    </button>
                </form>
                <p class="text-center text-sm text-slate-500 mt-4">
                    Don't have an account? 
                    <button id="switch-to-register" class="text-blue-600 font-semibold hover:underline">Register</button>
                </p>
                <button id="close-login-modal" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 text-2xl">&times;</button>
            </div>
        </div>

        <!-- Register Modal -->
        <div id="register-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl fade-in max-h-[90vh] overflow-y-auto">
                <div class="text-center mb-6">
                    <div class="text-4xl mb-2">üìù</div>
                    <h2 class="text-2xl font-bold text-slate-800">Create Account</h2>
                    <p class="text-slate-500">Join CLARA Healthcare</p>
                </div>
                <form id="register-form" class="space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-600 mb-1">First Name *</label>
                            <input type="text" id="register-firstname" required placeholder="John" 
                                class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-600 mb-1">Last Name *</label>
                            <input type="text" id="register-lastname" required placeholder="Doe" 
                                class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">Email *</label>
                        <input type="email" id="register-email" required placeholder="your@email.com" 
                            class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">Phone</label>
                        <input type="tel" id="register-phone" placeholder="+91 98765 43210" 
                            class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">Password *</label>
                        <input type="password" id="register-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6"
                            class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-600 mb-1">Role</label>
                        <select id="register-role" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="patient">Patient</option>
                            <option value="doctor">Doctor</option>
                        </select>
                    </div>
                    <div id="register-error" class="text-red-500 text-sm hidden"></div>
                    <button type="submit" class="w-full bg-green-600 text-white font-semibold py-3 rounded-lg hover:bg-green-700 transition">
                        Create Account
                    </button>
                </form>
                <p class="text-center text-sm text-slate-500 mt-4">
                    Already have an account? 
                    <button id="switch-to-login" class="text-blue-600 font-semibold hover:underline">Login</button>
                </p>
                <button id="close-register-modal" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600 text-2xl">&times;</button>
            </div>
        </div>

        <!-- Doctor Detail Modal -->
        <div id="doctor-detail-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 shadow-2xl fade-in max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-start mb-4">
                    <div class="flex items-center space-x-4">
                        <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center text-3xl">üë®‚Äç‚öïÔ∏è</div>
                        <div>
                            <h2 id="doc-modal-name" class="text-2xl font-bold text-slate-800">Dr. Name</h2>
                            <p id="doc-modal-specialization" class="text-blue-600 font-semibold">Specialization</p>
                            <div class="flex items-center space-x-2 mt-1">
                                <span id="doc-modal-rating" class="text-yellow-500">‚≠ê 0.0</span>
                                <span class="text-slate-400">|</span>
                                <span id="doc-modal-reviews" class="text-slate-500 text-sm">0 reviews</span>
                            </div>
                        </div>
                    </div>
                    <button id="close-doctor-modal" class="text-slate-400 hover:text-slate-600 text-2xl">&times;</button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div class="bg-slate-50 p-4 rounded-lg">
                        <p class="text-sm text-slate-500">Experience</p>
                        <p id="doc-modal-experience" class="font-semibold text-slate-800">0 years</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg">
                        <p class="text-sm text-slate-500">Consultation Fee</p>
                        <p id="doc-modal-fee" class="font-semibold text-green-600">‚Çπ0</p>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-semibold text-slate-800 mb-2">About</h3>
                    <p id="doc-modal-bio" class="text-slate-600 text-sm">No bio available.</p>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-semibold text-slate-800 mb-2">Qualifications</h3>
                    <ul id="doc-modal-qualifications" class="list-disc list-inside text-slate-600 text-sm"></ul>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-semibold text-slate-800 mb-2">Patient Reviews</h3>
                    <div id="doc-modal-reviews-list" class="space-y-3 max-h-48 overflow-y-auto"></div>
                </div>
                
                <button id="book-from-modal-btn" class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition">
                    üìÖ Book Appointment
                </button>
            </div>
        </div>

        <!-- Appointment Detail Modal -->
        <div id="appointment-detail-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-lg w-full mx-4 shadow-2xl fade-in">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-xl font-bold text-slate-800">Appointment Details</h2>
                        <p id="apt-modal-id" class="text-sm text-slate-500">APT-XXXXXXXX</p>
                    </div>
                    <button id="close-apt-modal" class="text-slate-400 hover:text-slate-600 text-2xl">&times;</button>
                </div>
                
                <div id="apt-modal-content" class="space-y-4">
                    <!-- Content filled dynamically -->
                </div>
                
                <div class="flex space-x-2 mt-6">
                    <button id="apt-reschedule-btn" class="flex-1 bg-yellow-500 text-white py-2 rounded-lg font-semibold hover:bg-yellow-600">
                        üìÖ Reschedule
                    </button>
                    <button id="apt-cancel-btn" class="flex-1 bg-red-500 text-white py-2 rounded-lg font-semibold hover:bg-red-600">
                        ‚ùå Cancel
                    </button>
                </div>
            </div>
        </div>

        <!-- Prescription Detail Modal -->
        <div id="prescription-detail-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 shadow-2xl fade-in max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-xl font-bold text-slate-800">Prescription</h2>
                        <p id="rx-modal-id" class="text-sm text-slate-500">RX-XXXXXXXX</p>
                    </div>
                    <button id="close-rx-modal" class="text-slate-400 hover:text-slate-600 text-2xl">&times;</button>
                </div>
                
                <div id="rx-modal-content" class="space-y-4">
                    <!-- Content filled dynamically -->
                </div>
                
                <div class="flex space-x-2 mt-6">
                    <button id="rx-download-btn" class="flex-1 bg-blue-600 text-white py-2 rounded-lg font-semibold hover:bg-blue-700">
                        üì• Download PDF
                    </button>
                    <button id="rx-print-btn" class="flex-1 bg-slate-200 text-slate-700 py-2 rounded-lg font-semibold hover:bg-slate-300">
                        üñ®Ô∏è Print
                    </button>
                </div>
            </div>
        </div>

        <!-- QR Code Modal -->
        <div id="qr-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-sm w-full mx-4 shadow-2xl fade-in">
                <div class="text-center">
                    <h3 class="text-xl font-bold text-slate-800 mb-2">üì± Scan to Email Report</h3>
                    <p class="text-sm text-slate-500 mb-4">Scan with your phone to receive the clinical report via email</p>
                    <div id="qr-code-container" class="flex justify-center mb-4"></div>
                    <p class="text-xs text-slate-400 mb-4">Or share this link:</p>
                    <input id="qr-link-input" type="text" readonly class="w-full p-2 text-xs bg-slate-100 border rounded text-slate-600 mb-4">
                    <div class="flex space-x-2">
                        <button id="copy-qr-link" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-blue-700">
                            üìã Copy Link
                        </button>
                        <button id="close-qr-modal" class="flex-1 bg-slate-200 text-slate-700 py-2 px-4 rounded-lg font-semibold hover:bg-slate-300">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Patient Timeline Modal -->
        <div id="timeline-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 shadow-2xl fade-in max-h-[80vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-slate-800">üìÖ Patient History Timeline</h3>
                    <button id="close-timeline-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div id="timeline-content" class="space-y-4"></div>
            </div>
        </div>

    </main>

    <footer class="text-center p-4 text-sm text-slate-500 mt-8 border-t border-slate-200">
        <p>CLARA v2.0 - Clinical Legal AI for Risk Avoidance</p>
        <p class="text-xs mt-1">Powered by Google Gemini AI with RAG Enhancement</p>
    </footer>
    
    <script src="env.js"></script>
    <script type="module" src="index.js"></script>
</body>
</html>
